<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="iiwa2">

  <material name="gray">
    <color rgba="0.5 0.5 0.5 1.0"/>
  </material>

  <link name="base_link"/>

  <joint name="iiwa2_base_joint" type="fixed">
    <origin rpy="0.0 0 0" xyz="0 0 0"/>
    <parent link="base_link"/>
    <child link="iiwa2_link_0"/>
  </joint>

  <link name="iiwa2_link_0">
    <visual>
      <geometry><mesh filename="file://$(find iiwa_description)/meshes/lbr_iiwa_14_r820/visual/base_link.dae"/></geometry>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0.05"/>
      <geometry><cylinder radius="0.08" length="0.1"/></geometry>
    </collision>
    <inertial>
      <origin xyz="-0.1 0 0.07" rpy="0 0 0"/><mass value="5"/><inertia ixx="0.05" ixy="0" ixz="0" iyy="0.06" iyz="0" izz="0.03" />
    </inertial>
  </link>
  
  <link name="iiwa2_link_1">
    <visual>
      <geometry><mesh filename="file://$(find iiwa_description)/meshes/lbr_iiwa_14_r820/visual/link_1.dae"/></geometry>
    </visual>
    <collision>
      <origin xyz="0 0 0.18" rpy="0 0 0"/>
      <geometry><cylinder radius="0.06" length="0.36"/></geometry>
    </collision>
    <inertial>
      <origin xyz="0 -0.03 0.12" rpy="0 0 0"/><mass value="4"/><inertia ixx="0.1" ixy="0" ixz="0" iyy="0.09" iyz="0" izz="0.02" />
    </inertial>
  </link>

  <link name="iiwa2_link_2">
    <visual>
      <geometry><mesh filename="file://$(find iiwa_description)/meshes/lbr_iiwa_14_r820/visual/link_2.dae"/></geometry>
    </visual>
    <collision>
      <origin xyz="0 0.04 0" rpy="0 0 0"/>
      <geometry><cylinder radius="0.055" length="0.1"/></geometry>
    </collision>
    <inertial>
      <origin xyz="0.0003 0.059 0.042" rpy="0 0 0"/><mass value="4"/><inertia ixx="0.05" ixy="0" ixz="0" iyy="0.018" iyz="0" izz="0.044" />
    </inertial>
  </link>

  <link name="iiwa2_link_3">
    <visual>
      <geometry><mesh filename="file://$(find iiwa_description)/meshes/lbr_iiwa_14_r820/visual/link_3.dae"/></geometry>
    </visual>
    <collision>
      <origin xyz="0 0 0.21" rpy="0 0 0"/>
      <geometry><cylinder radius="0.055" length="0.42"/></geometry>
    </collision>
    <inertial>
      <origin xyz="0 0.03 0.13" rpy="0 0 0"/><mass value="3"/><inertia ixx="0.08" ixy="0" ixz="0" iyy="0.075" iyz="0" izz="0.01" />
    </inertial>
  </link>

  <link name="iiwa2_link_4">
    <visual>
      <geometry><mesh filename="file://$(find iiwa_description)/meshes/lbr_iiwa_14_r820/visual/link_4.dae"/></geometry>
    </visual>
    <collision>
      <origin xyz="0 0.04 0" rpy="0 0 0"/>
      <geometry><cylinder radius="0.05" length="0.1"/></geometry>
    </collision>
    <inertial>
      <origin xyz="0 0.067 0.034" rpy="0 0 0"/><mass value="2.7"/><inertia ixx="0.03" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.029" />
    </inertial>
  </link>

  <link name="iiwa2_link_5">
    <visual>
      <geometry><mesh filename="file://$(find iiwa_description)/meshes/lbr_iiwa_14_r820/visual/link_5.dae"/></geometry>
    </visual>
    <collision>
      <origin xyz="0 0 0.2" rpy="0 0 0"/>
      <geometry><cylinder radius="0.045" length="0.4"/></geometry>
    </collision>
    <inertial>
      <origin xyz="0.0001 0.021 0.076" rpy="0 0 0"/><mass value="1.7"/><inertia ixx="0.02" ixy="0" ixz="0" iyy="0.018" iyz="0" izz="0.005" />
    </inertial>
  </link>

  <link name="iiwa2_link_6">
    <visual>
      <geometry><mesh filename="file://$(find iiwa_description)/meshes/lbr_iiwa_14_r820/visual/link_6.dae"/></geometry>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry><cylinder radius="0.04" length="0.08"/></geometry>
    </collision>
    <inertial>
      <origin xyz="0 0.0006 0.0004" rpy="0 0 0"/><mass value="1.8"/><inertia ixx="0.025" ixy="0" ixz="0" iyy="0.0136" iyz="0" izz="0.0247" />
    </inertial>
  </link>

  <link name="iiwa2_link_7">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0.07"/>
      <material name="gray"/>
      <geometry><mesh filename="file://$(find iiwa_description)/meshes/lbr_iiwa_14_r820/visual/link_7_2.stl" scale="0.001 0.001 0.001"/></geometry>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0.077"/>
      <geometry><cylinder radius="0.035" length="0.154"/></geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0.02" rpy="0 0 0"/><mass value="0.43"/><inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01" />
    </inertial>
  </link>

  <link name="iiwa2_tool0"/>

  <link name="iiwa2_camera_link">
    <visual>
      <geometry><box size="0.03 0.03 0.03"/></geometry>
      <material name="black"><color rgba="0 0 0 1"/></material>
    </visual>
    <collision><geometry><box size="0.03 0.03 0.03"/></geometry></collision>
    <inertial><mass value="0.01"/><inertia ixx="0.0001" ixy="0" ixz="0" iyy="0.0001" iyz="0" izz="0.0001"/></inertial>
  </link>

  <joint name="iiwa2_joint_a1" type="revolute">
    <origin rpy="0 0 0" xyz="0 0 0"/><parent link="iiwa2_link_0"/><child link="iiwa2_link_1"/><axis xyz="0 0 1"/>
    <limit effort="320" lower="-2.9668" upper="2.9668" velocity="1.4834"/>
    <dynamics damping="1.0" friction="0.5"/>
  </joint>
  <joint name="iiwa2_joint_a2" type="revolute">
    <origin rpy="0 0 0" xyz="-0.00043624 0 0.36"/><parent link="iiwa2_link_1"/><child link="iiwa2_link_2"/><axis xyz="0 1 0"/>
    <limit effort="320" lower="-2.0942" upper="2.0942" velocity="1.4834"/>
    <dynamics damping="1.0" friction="0.5"/>
  </joint>
  <joint name="iiwa2_joint_a3" type="revolute">
    <origin rpy="0 0 0" xyz="0 0 0"/><parent link="iiwa2_link_2"/><child link="iiwa2_link_3"/><axis xyz="0 0 1"/>
    <limit effort="176" lower="-2.9668" upper="2.9668" velocity="1.7452"/>
    <dynamics damping="1.0" friction="0.5"/>
  </joint>
  <joint name="iiwa2_joint_a4" type="revolute">
    <origin rpy="0 0 0" xyz="0.00043624 0 0.42"/><parent link="iiwa2_link_3"/><child link="iiwa2_link_4"/><axis xyz="0 -1 0"/>
    <limit effort="176" lower="-2.0942" upper="2.0942" velocity="1.3089"/>
    <dynamics damping="1.0" friction="0.5"/>
  </joint>
  <joint name="iiwa2_joint_a5" type="revolute">
    <origin rpy="0 0 0" xyz="0 0 0"/><parent link="iiwa2_link_4"/><child link="iiwa2_link_5"/><axis xyz="0 0 1"/>
    <limit effort="110" lower="-2.9668" upper="2.9668" velocity="2.2688"/>
    <dynamics damping="0.7" friction="0.3"/>
  </joint>
  <joint name="iiwa2_joint_a6" type="revolute">
    <origin rpy="0 0 0" xyz="0 0 0.4"/><parent link="iiwa2_link_5"/><child link="iiwa2_link_6"/><axis xyz="0 1 0"/>
    <limit effort="40" lower="-2.0942" upper="2.0942" velocity="2.356"/>
    <dynamics damping="0.7" friction="0.3"/>
  </joint>
  <joint name="iiwa2_joint_a7" type="revolute">
    <origin rpy="0 0 0" xyz="0 0 0"/><parent link="iiwa2_link_6"/><child link="iiwa2_link_7"/><axis xyz="0 0 1"/>
    <limit effort="40" lower="-3.0541" upper="3.0541" velocity="2.356"/>
    <dynamics damping="0.5" friction="0.2"/>
  </joint>
  
  <joint name="iiwa2_joint_a7-tool0" type="fixed">
    <origin rpy="0 0 0" xyz="0 0 0.154"/><parent link="iiwa2_link_7"/><child link="iiwa2_tool0"/></joint>

  <joint name="iiwa2_camera_joint" type="fixed">
    <parent link="iiwa2_tool0"/><child link="iiwa2_camera_link"/><origin xyz="0 0 0.02" rpy="0 0 0"/></joint>

  <gazebo reference="iiwa2_link_7">
    <material>Gazebo/Gray</material>
  </gazebo>

  <gazebo reference="iiwa2_camera_link">
    <sensor name="iiwa2_camera" type="camera">
      <always_on>true</always_on><update_rate>30</update_rate><visualize>true</visualize><topic>iiwa2_camera</topic>
      <camera><horizontal_fov>1.047</horizontal_fov><image><width>640</width><height>480</height><format>R8G8B8</format></image><clip><near>0.02</near><far>10.0</far></clip></camera>
    </sensor>
  </gazebo>

  <ros2_control name="iiwa2_hardware" type="system">
    <hardware><plugin>gz_ros2_control/GazeboSimSystem</plugin></hardware>
    <joint name="iiwa2_joint_a1"><command_interface name="position"/><state_interface name="position"/><state_interface name="velocity"/></joint>
    <joint name="iiwa2_joint_a2"><command_interface name="position"/><state_interface name="position"/><state_interface name="velocity"/></joint>
    <joint name="iiwa2_joint_a3"><command_interface name="position"/><state_interface name="position"/><state_interface name="velocity"/></joint>
    <joint name="iiwa2_joint_a4"><command_interface name="position"/><state_interface name="position"/><state_interface name="velocity"/></joint>
    <joint name="iiwa2_joint_a5"><command_interface name="position"/><state_interface name="position"/><state_interface name="velocity"/></joint>
    <joint name="iiwa2_joint_a6"><command_interface name="position"/><state_interface name="position"/><state_interface name="velocity"/></joint>
    <joint name="iiwa2_joint_a7"><command_interface name="position"/><state_interface name="position"/><state_interface name="velocity"/></joint>
  </ros2_control>

  <gazebo>
    <plugin filename="libgz_ros2_control-system.so" name="gz_ros2_control::GazeboSimROS2ControlPlugin">
      <parameters>$(find iiwa_description)/config/iiwa2_controllers.yaml</parameters>
      <robot_param>robot_description</robot_param>
      <robot_param_node>robot_state_publisher</robot_param_node>
      <ros>
       <namespace>iiwa2</namespace>
       <remapping>controller_manager/robot_description:=robot_description</remapping>
     </ros>
    </plugin>
  </gazebo>
</robot>